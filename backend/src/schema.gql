# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type ActivityCourse {
  id: ID!
  slug: String!
  title: String!
}

type ActivityStudent {
  id: ID!
  image: String
  name: String!
}

"""Type d'activité récente"""
enum ActivityType {
  COMPLETION
  ENROLLMENT
  LESSON_COMPLETED
  QUESTION
  REVIEW
}

type AdminActionResponse {
  """Message de confirmation ou d'erreur"""
  message: String!

  """Indique si l'action a réussi"""
  success: Boolean!
}

type AdminStats {
  """Nombre d'étudiants actifs"""
  activeStudents: Int!

  """Nombre d'inscriptions récentes"""
  recentEnrollments: Int!

  """Nombre total de cours"""
  totalCourses: Int!

  """Revenus totaux générés"""
  totalRevenue: Float!

  """Nombre total d'utilisateurs"""
  totalUsers: Int!
}

type AnalyticsOverview {
  averageCompletionRate: Float!
  averageWatchTime: Float!
  comparisonPeriod: DateRangeType!
  completionRateChange: PercentageChange!
  currentPeriod: DateRangeType!
  enrollmentsChange: PercentageChange!
  revenueChange: PercentageChange!
  studentsChange: PercentageChange!
  totalEnrollments: Int!
  totalRevenue: Float!
  totalStudents: Int!
}

enum ChangeDirection {
  DOWN
  STABLE
  UP
}

type Chapter {
  completedLessonsCount: Int
  course: Course!
  createdAt: DateTime!
  id: ID!
  lessons: [Lesson!]
  lessonsCount: Int
  position: Int!
  title: String!
  updatedAt: DateTime!
}

input ChapterPositionInput {
  id: String!
  position: Int!
}

type CheckoutSessionResponse {
  url: String!
}

type ConversationDetailOutput {
  courseId: String
  courseTitle: String
  createdAt: DateTime!
  id: String!
  messages: [MessageOutput!]!
  participantEmail: String
  participantId: String!
  participantImage: String
  participantName: String!
  totalMessages: Int!
}

type ConversationListResponseOutput {
  conversations: [ConversationPreviewOutput!]!
  page: Int!
  pageSize: Int!
  total: Int!
}

type ConversationPreviewOutput {
  courseId: String
  courseTitle: String
  id: String!
  lastMessage: String
  lastMessageAt: DateTime
  participantEmail: String
  participantId: String!
  participantImage: String
  participantName: String!
  unreadCount: Int!
}

type Course {
  category: String!
  chapters: [Chapter!]
  chaptersCount: Int
  createdAt: DateTime!
  createdBy: CourseCreator!
  description: String!
  duration: Int
  enrollmentsCount: Int
  fileKey: String
  id: ID!
  imageUrl: String
  level: CourseLevel!
  outcomes: String
  price: Float!
  progress: CourseProgressOutput
  publishedAt: DateTime
  requirements: String
  slug: String!
  smallDescription: String!
  status: CourseStatus!
  stripePriceId: String
  title: String!
  updatedAt: DateTime!
  userId: String!
}

type CourseCreator {
  email: String
  id: String!
  name: String!
  role: UserRole!
}

"""The difficulty level of a course"""
enum CourseLevel {
  """Advanced level course"""
  Advanced

  """Beginner level course"""
  Beginner

  """Intermediate level course"""
  Intermediate
}

type CoursePerformance {
  activeStudents: Int!
  averageProgress: Float!
  completionRate: Float!
  courseId: String!
  courseName: String!
  enrollmentTrend: PercentageChange!
  thumbnailUrl: String
  totalEnrollments: Int!
  totalRevenue: Float!
}

type CoursePerformanceOutput {
  activeStudentsCount: Int!
  averageRating: Float
  chaptersCount: Int!
  completionRate: Float!
  createdAt: DateTime!
  duration: Int
  id: ID!
  imageUrl: String
  lessonsCount: Int!
  price: Float!
  publishedAt: DateTime
  revenue: Float!
  reviewsCount: Int
  slug: String!
  status: CourseStatus!
  studentsCount: Int!
  title: String!
  updatedAt: DateTime!
}

type CourseProgressOutput {
  completedCount: Int!
  percentage: Int!
  totalCount: Int!
}

"""The publication status of a course"""
enum CourseStatus {
  """Course is archived"""
  Archived

  """Course is in draft mode"""
  Draft

  """Course is published and visible to users"""
  Published
}

input CreateChapterInput {
  courseId: String!
  description: String
  position: Int
  title: String!
}

input CreateCourseInput {
  category: String
  description: String!
  duration: Int
  imageUrl: String
  level: CourseLevel
  outcomes: String
  price: Float!
  requirements: String
  smallDescription: String
  status: CourseStatus
  stripePriceId: String
  title: String!
}

input CreateLessonAttachmentInput {
  fileName: String!
  fileSize: Int!
  fileType: String!
  fileUrl: String!
  lessonId: String!
}

input CreateLessonInput {
  content: String
  description: String
  duration: Int
  externalVideoUrl: String
  isFree: Boolean = false
  order: Int
  thumbnailKey: String
  title: String!
  videoKey: String
  videoUrl: String
}

input DateRangeInput {
  endDate: DateTime!
  startDate: DateTime!
}

type DateRangeType {
  endDate: DateTime!
  startDate: DateTime!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

type DeleteMediaResponse {
  message: String
  success: Boolean!
}

input EnrollInCourseInput {
  courseId: String!
}

type Enrollment {
  completedAt: DateTime
  course: Course!
  courseId: String!
  createdAt: DateTime!
  expiresAt: DateTime
  id: ID!
  status: String!
  user: User
  userId: String!
}

type EnrollmentResponse {
  checkoutUrl: String
  enrollmentId: String
  message: String!
  success: Boolean!
}

type ExportRevenueResponse {
  downloadUrl: String!
  filename: String!
  success: Boolean!
}

type InstructorRevenueResponse {
  availableBalance: Float!
  averageDailyRevenue: Float!
  changeDirection: RevenueInstructorChangeDirection!
  changePercentage: Float!
  currency: String!
  dataPoints: [RevenueChartDataPoint!]!
  nextPayoutDate: DateTime!
  payoutHistory: [RevenueInstructorPayout!]!
  periodEnd: DateTime!
  periodStart: DateTime!
  previousPeriodRevenue: Float!
  totalRevenue: Float!
  transactionCount: Int!
  transactions: [RevenueInstructorTransaction!]!
}

type InstructorStatsOutput {
  activeStudents: Int!
  archivedCourses: Int!
  averageCompletionRate: Float!
  averageRating: Float
  draftCourses: Int!
  monthlyRevenue: Float!
  publishedCourses: Int!
  totalCourses: Int!
  totalRevenue: Float!
  totalStudents: Int!
  totalViews: Int!
  weeklyViews: Int!
}

type Lesson {
  chapter: Chapter
  completed: Boolean
  content: String
  createdAt: DateTime!
  description: String
  duration: Int
  externalVideoUrl: String
  id: ID!
  isCompleted: Boolean
  isFree: Boolean!
  isPublished: Boolean!
  lessonProgress: [LessonProgress!]
  order: Int!
  thumbnailKey: String
  title: String!
  updatedAt: DateTime!
  videoKey: String
  videoUrl: String
}

type LessonAttachment {
  createdAt: DateTime!
  fileName: String!
  fileSize: Int!
  fileType: String!
  fileUrl: String!
  id: String!
  lessonId: String!
  updatedAt: DateTime!
}

input LessonPositionInput {
  id: String!
  position: Int!
}

type LessonProgress {
  completed: Boolean!
  completedAt: DateTime
  courseId: String!
  createdAt: DateTime!
  id: ID!
  lessonId: String!
  updatedAt: DateTime!
  userId: String!
}

type MediaAssetType {
  createdAt: DateTime!
  description: String
  filename: String!
  height: Int!
  id: String!
  isPublic: Boolean!
  lastUsedAt: DateTime
  size: Int!
  tags: [String!]!
  urlLarge: String!
  urlMedium: String!
  urlOriginal: String!
  urlThumbnail: String!
  usageCount: Int!
  width: Int!
}

type MessageOutput {
  content: String!
  createdAt: DateTime!
  id: String!
  readAt: DateTime
  senderId: String!
  senderImage: String
  senderName: String!
  status: MessageStatus!
}

enum MessageStatus {
  DELIVERED
  READ
  SENT
}

type MessagesStatsOutput {
  lastMessageReceivedAt: DateTime
  totalConversations: Int!
  totalUnreadMessages: Int!
  unreadConversations: Int!
}

type Mutation {
  adminUpdateUserRole(input: UpdateUserRoleInput!): AdminActionResponse!
  archiveCourse(id: String!): Course!

  """Ban user (ADMIN only)"""
  banUser(expiresAt: DateTime, reason: String, userId: String!): User!
  createChapter(input: CreateChapterInput!): Chapter!

  """Créer une session Stripe Checkout pour acheter un cours"""
  createCheckoutSession(
    """ID du cours à acheter"""
    courseId: String!
  ): CheckoutSessionResponse!
  createCourse(input: CreateCourseInput!): Course!
  createLesson(chapterId: String!, input: CreateLessonInput!): Lesson!
  createLessonAttachment(input: CreateLessonAttachmentInput!): LessonAttachment!

  """Désactiver un compte utilisateur (ADMIN uniquement)"""
  deactivateUser(userId: String!): AdminActionResponse!
  deleteChapter(id: String!): Boolean!
  deleteCourse(courseId: String!): Boolean!
  deleteFile(url: String!): Boolean!
  deleteLesson(id: String!): Boolean!
  deleteLessonAttachment(id: String!): Boolean!

  """Soft delete media (recoverable for 30 days)"""
  deleteMedia(mediaId: String!): DeleteMediaResponse!

  """Delete video progress (reset)"""
  deleteVideoProgress(lessonId: String!): Boolean!
  enrollInCourse(input: EnrollInCourseInput!): EnrollmentResponse!
  getUploadUrl(contentType: String!, fileName: String!): UploadUrlResponse!
  getUploadUrlForVideo(fileName: String!, fileSize: Float!, fileType: String!): UploadUrlResponse!

  """Marque tous les messages d'une conversation comme lus"""
  markConversationAsRead(conversationId: String!): Boolean!
  markLessonAsCompleted(lessonId: String!): LessonProgress!

  """Manually mark a lesson as completed"""
  markLessonCompleted(lessonId: String!): VideoProgress!

  """Promote STUDENT to INSTRUCTOR (ADMIN only)"""
  promoteToInstructor(input: PromoteUserInput!): User!
  publishCourse(id: String!): Course!
  reorderChapters(input: ReorderChaptersInput!): [Chapter!]!
  reorderLessons(input: ReorderLessonsInput!): [Lesson!]!

  """Save video progress (auto-save every 5 seconds)"""
  saveVideoProgress(input: SaveVideoProgressInput!): VideoProgress!

  """Envoie un message à un étudiant"""
  sendMessage(content: String!, courseId: String, studentId: String!): SendMessageOutput!
  setupUserRole(clerkUserId: String!, role: String!): User!

  """Envoie un message à l'instructor du cours"""
  studentSendMessage(content: String!, courseId: String, instructorId: String!): SendMessageOutput!
  toggleLessonCompletion(lessonId: String!): LessonProgress!

  """Track media usage for analytics"""
  trackMediaUsage(mediaId: String!): Boolean!

  """Unban user (ADMIN only)"""
  unbanUser(userId: String!): User!
  updateChapter(input: UpdateChapterInput!): Chapter!
  updateCourse(input: UpdateCourseInput!): Course!
  updateLesson(id: String!, input: UpdateLessonInput!): Lesson!
  updateLessonContent(input: UpdateLessonContentInput!): Lesson!
  updateLessonProgress(input: UpdateProgressInput!, lessonId: String!): LessonProgress!

  """Met à jour l'avatar de l'utilisateur actuellement authentifié"""
  updateUserAvatar(avatarKey: String!, avatarUrl: String!): UpdateUserAvatarResponse!

  """Update user preferences"""
  updateUserPreferences(input: UpdateUserPreferencesInput!): UserPreferences!

  """Update user profile"""
  updateUserProfile(input: UpdateUserProfileInput!): User!

  """Update user role (ADMIN only)"""
  updateUserRole(input: UpdateUserRoleInput!): User!

  """
  Upload un avatar utilisateur. Compresse automatiquement en WEBP 200x200.
  """
  uploadUserAvatar(file: Upload!): UploadAvatarResponse!
}

type PercentageChange {
  direction: ChangeDirection!
  isSignificant: Boolean!
  value: Float!
}

input PromoteUserInput {
  userId: String!
}

type Query {
  """Statistiques globales de la plateforme (ADMIN uniquement)"""
  adminStats: AdminStats!
  chaptersByCourse(courseId: String!): [Chapter!]!

  """Détails complets d'une conversation avec tous les messages"""
  conversationDetail(conversationId: String!, limit: Int = 50): ConversationDetailOutput!
  course(id: String!): Course!
  courseBySlug(slug: String!): Course!

  """Performances détaillées d'un cours"""
  coursePerformance(courseId: String!): CoursePerformanceOutput!
  courseProgress(courseId: String!): CourseProgressOutput!

  """Liste de tous les cours, publiés ou non (ADMIN uniquement)"""
  courses: [Course!]!
  exportAnalytics(dateRange: DateRangeInput!, type: String!): String!

  """Exporte les revenus en CSV"""
  exportRevenue(period: RevenueInstructorPeriod!): ExportRevenueResponse!

  """Get all users (ADMIN only)"""
  getAllUsers: [User!]!
  getCourseForEdit(id: String!): Course!

  """Get current user profile"""
  getCurrentUser: User!

  """Données complètes des revenus de l'instructeur"""
  getInstructorRevenue(period: RevenueInstructorPeriod! = LAST_30_DAYS): InstructorRevenueResponse!

  """Get single media by ID"""
  getMediaById(id: String!): MediaAssetType

  """Get total count of user media"""
  getMyMediaCount: Float!

  """Get paginated list of user media library"""
  getMyMediaLibrary(skip: Int! = 0, take: Int! = 20): [MediaAssetType!]!

  """Get user by ID"""
  getUserById(userId: String!): User!

  """Get user statistics"""
  getUserStats: UserStats!

  """Get all video progress for current user (sorted by recent)"""
  getUserVideoProgress: [VideoProgress!]!

  """Get video progress for a specific lesson"""
  getVideoProgress(lessonId: String!): VideoProgress
  hello: String!
  instructorAnalytics(dateRange: DateRangeInput!): AnalyticsOverview!

  """Liste paginée des conversations de l'instructeur"""
  instructorConversations(page: Int = 1, pageSize: Int = 10, search: String): ConversationListResponseOutput!
  instructorCoursePerformance(dateRange: DateRangeInput!): [CoursePerformance!]!

  """Liste des cours de l'instructeur avec performances"""
  instructorCourses(status: CourseStatus): [CoursePerformanceOutput!]!
  instructorRevenue(dateRange: DateRangeInput!): RevenueAnalytics!

  """Statistiques globales de l'instructeur (dashboard)"""
  instructorStats: InstructorStatsOutput!

  """Liste paginée des étudiants de l'instructeur"""
  instructorStudents(courseId: String, page: Int = 1, pageSize: Int = 10, search: String, sortBy: String = "enrolledAt"): StudentListResponse!
  isEnrolled(courseId: String!): Boolean!
  lesson(id: String!): Lesson!
  lessonAttachments(lessonId: String!): [LessonAttachment!]!
  lessonForEdit(id: String!): Lesson!
  lessonProgress(lessonId: String!): LessonProgress
  lessonsByChapter(chapterId: String!): [Lesson!]!
  me: User!

  """Statistiques des messages (conversations, unread count)"""
  messagesStats: MessagesStatsOutput!
  myCourses: [Course!]!
  myEnrolledCourses: [Course!]!
  myEnrollments: [Enrollment!]!

  """Liste publique des cours publiés"""
  publicCourses: [Course!]!

  """Activités récentes de l'instructeur (enrollments, completions)"""
  recentActivity(limit: Int = 10): [RecentActivityOutput!]!

  """Détails complets d'une conversation avec tous les messages"""
  studentConversationDetail(conversationId: String!, limit: Int = 50): ConversationDetailOutput!

  """Liste des conversations de l'étudiant connecté"""
  studentConversations(courseId: String, page: Int = 1, pageSize: Int = 10, search: String): ConversationListResponseOutput!

  """Détails complets d'un étudiant"""
  studentDetail(studentId: String!): StudentDetail!

  """Étudiants inscrits à un cours spécifique"""
  studentsByCourse(courseId: String!, page: Int = 1, pageSize: Int = 10, search: String, sortBy: String = "enrolledAt"): StudentListResponse!

  """Liste de tous les utilisateurs (ADMIN uniquement)"""
  users: [User!]!

  """API version"""
  version: String!
}

type RecentActivityOutput {
  course: ActivityCourse!
  createdAt: DateTime!
  id: ID!
  lessonTitle: String
  rating: Float
  reviewText: String
  student: ActivityStudent!
  type: ActivityType!
}

input ReorderChaptersInput {
  chapters: [ChapterPositionInput!]!
  courseId: String!
}

input ReorderLessonsInput {
  chapterId: String!
  lessons: [LessonPositionInput!]!
}

type RevenueAnalytics {
  dataPoints: [RevenueDataPoint!]!
  totalRevenue: Float!
}

type RevenueChartDataPoint {
  date: String!
  revenue: Float!
  transactionCount: Int!
}

type RevenueDataPoint {
  date: DateTime!
  enrollments: Int!
  revenue: Float!
}

enum RevenueInstructorChangeDirection {
  DOWN
  STABLE
  UP
}

type RevenueInstructorPayout {
  amount: Float!
  bankAccount: String!
  date: DateTime!
  id: String!
  status: RevenueInstructorPayoutStatus!
}

enum RevenueInstructorPayoutStatus {
  COMPLETED
  FAILED
  PENDING
}

enum RevenueInstructorPeriod {
  LAST_7_DAYS
  LAST_30_DAYS
  LAST_90_DAYS
  YEAR
}

type RevenueInstructorTransaction {
  amount: Float!
  courseId: String!
  courseName: String!
  date: DateTime!
  id: String!
  status: RevenueInstructorTransactionStatus!
  studentName: String!
}

enum RevenueInstructorTransactionStatus {
  PAID
  PENDING
  REFUNDED
}

input SaveVideoProgressInput {
  currentTime: Float!
  duration: Float!
  lessonId: String!
}

type SendMessageOutput {
  error: String
  message: MessageOutput
  success: Boolean!
}

type StudentAchievement {
  description: String!
  icon: String
  id: String!
  title: String!
  unlockedAt: DateTime!
}

type StudentCourseProgress {
  courseId: String!
  courseImage: String
  courseSlug: String!
  courseTitle: String!
  enrollment: StudentEnrollment!
  price: Float!
}

type StudentDetail {
  achievements: [StudentAchievement!]!
  averageTimePerLesson: Int!
  courses: [StudentCourseProgress!]!
  email: String
  enrolledAt: DateTime!
  id: String!
  image: String
  joinedAt: DateTime!
  lastActivityAt: DateTime
  name: String!
  overallCompletionRate: Float!
  totalCoursesCompleted: Int!
  totalCoursesEnrolled: Int!
  totalTimeSpent: Int!
}

type StudentEnrollment {
  completionRate: Int!
  enrolledAt: DateTime!
  id: String!
  lastActivityAt: DateTime
  lessonsCompleted: Int!
  status: String!
  totalLessons: Int!
}

type StudentListItem {
  courses: [StudentCourseProgress!]!
  email: String
  enrolledAt: DateTime!
  id: String!
  image: String
  lastActivityAt: DateTime
  name: String!
  overallCompletionRate: Float!
  totalCoursesCompleted: Int!
  totalCoursesEnrolled: Int!
}

type StudentListResponse {
  page: Int!
  pageSize: Int!
  students: [StudentListItem!]!
  total: Int!
}

input UpdateChapterInput {
  description: String
  id: String!
  position: Int
  title: String
}

input UpdateCourseInput {
  category: String
  description: String
  duration: Float
  id: String!
  imageUrl: String
  level: CourseLevel
  outcomes: String
  price: Float
  requirements: String
  smallDescription: String
  status: CourseStatus
  stripePriceId: String
  title: String
}

input UpdateLessonContentInput {
  content: String
  isPublished: Boolean
  lessonId: String!
}

input UpdateLessonInput {
  content: String
  description: String
  duration: Int
  externalVideoUrl: String
  isFree: Boolean = false
  order: Int
  thumbnailKey: String
  title: String
  videoKey: String
  videoUrl: String
}

input UpdateProgressInput {
  watchedDuration: Int!
}

type UpdateUserAvatarResponse {
  message: String
  success: Boolean!
  user: User
}

input UpdateUserPreferencesInput {
  autoplay: Boolean
  courseUpdates: Boolean
  emailNotifications: Boolean
  language: String
  marketingEmails: Boolean
  subtitles: Boolean
  theme: String
  timezone: String
  videoQuality: String
  weeklyDigest: Boolean
}

input UpdateUserProfileInput {
  bio: String
  dateOfBirth: String
  profession: String
}

input UpdateUserRoleInput {
  """Nouveau rôle à attribuer"""
  newRole: UserRole!

  """ID de l'utilisateur"""
  userId: String!
}

"""The `Upload` scalar type represents a file upload."""
scalar Upload

type UploadAvatarResponse {
  avatarUrl: String!
  message: String
  success: Boolean!
}

type UploadUrlResponse {
  key: String!
  publicUrl: String!
  uploadUrl: String!
}

type User {
  _count: UserCounts
  avatarKey: String
  avatarUrl: String
  banExpires: DateTime
  banReason: String
  banned: Boolean
  bio: String
  clerkId: String
  createdAt: DateTime!
  dateOfBirth: DateTime
  email: String
  emailVerified: Boolean
  id: ID!
  image: String
  lastLoginAt: DateTime
  name: String
  preferences: UserPreferences
  profession: String
  role: UserRole
  stripeCustomerId: String
  updatedAt: DateTime
}

type UserCounts {
  coursesCreated: Float!
  enrollments: Float!
}

type UserPreferences {
  autoplay: Boolean!
  courseUpdates: Boolean!
  createdAt: DateTime!
  emailNotifications: Boolean!
  id: ID!
  language: String!
  marketingEmails: Boolean!
  subtitles: Boolean!
  theme: String!
  timezone: String!
  updatedAt: DateTime!
  userId: ID!
  videoQuality: String!
  weeklyDigest: Boolean!
}

"""The role of a user in the system"""
enum UserRole {
  """Administrator with full permissions"""
  ADMIN

  """Instructor who can create and manage courses"""
  INSTRUCTOR

  """Regular user with basic permissions"""
  STUDENT
}

type UserStats {
  admins: Int!
  instructors: Int!
  students: Int!
  totalUsers: Int!
}

type VideoProgress {
  completedAt: DateTime
  createdAt: DateTime!
  currentTime: Float!
  duration: Float!
  id: ID!
  isCompleted: Boolean!
  lastWatchedAt: DateTime!
  lesson: Lesson
  lessonId: String!
  progressPercent: Float!
  updatedAt: DateTime!
  user: User
  userId: String!
}